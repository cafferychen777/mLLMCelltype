% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/marker_gene_visualization.R
\name{create_marker_bubble_plot}
\alias{create_marker_bubble_plot}
\title{Create Enhanced Marker Gene Bubble Plot}
\usage{
create_marker_bubble_plot(
  seurat_obj,
  markers_df,
  consensus_results,
  top_n = 5,
  title = "Marker Gene Expression by Cell Type",
  color_palette = "plasma"
)
}
\arguments{
\item{seurat_obj}{A Seurat object containing the single-cell data}

\item{markers_df}{A data frame containing marker genes (output from FindAllMarkers)}

\item{consensus_results}{Results from interactive_consensus_annotation function}

\item{top_n}{Number of top marker genes to display per cell type (default: 5)}

\item{title}{Plot title (default: "Marker Gene Expression by Cell Type")}

\item{color_palette}{Color palette for expression levels (default: "plasma")}
}
\value{
A list containing the ggplot object and the underlying data
}
\description{
Creates a publication-ready bubble plot showing marker gene expression across cell types.
The plot displays both the percentage of cells expressing each gene (bubble size) and
the average expression level (color intensity).
}
\examples{
\dontrun{
# Run consensus annotation first
consensus_results <- interactive_consensus_annotation(
  input = markers_df,
  tissue_name = "human PBMC",
  models = c("anthropic/claude-3.5-sonnet", "openai/gpt-4o"),
  api_keys = list(openrouter = "your_api_key")
)

# Create bubble plot
bubble_plot <- create_marker_bubble_plot(
  seurat_obj = pbmc_data,
  markers_df = markers_df,
  consensus_results = consensus_results,
  top_n = 5
)

# Display the plot
print(bubble_plot$plot)
}

}
