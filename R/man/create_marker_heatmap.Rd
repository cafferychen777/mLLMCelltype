% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/marker_gene_visualization.R
\name{create_marker_heatmap}
\alias{create_marker_heatmap}
\title{Create Enhanced Marker Gene Heatmap}
\usage{
create_marker_heatmap(
  seurat_obj,
  markers_df,
  consensus_results,
  top_n = 5,
  title = "Marker Gene Expression Heatmap",
  color_palette = NULL,
  cluster_genes = TRUE,
  scale_method = "row",
  width = 4000,
  height = 3000,
  fontsize = 20,
  cellwidth = 100,
  cellheight = 50,
  margins = c(20, 20)
)
}
\arguments{
\item{seurat_obj}{A Seurat object containing the single-cell data}

\item{markers_df}{A data frame containing marker genes (output from FindAllMarkers)}

\item{consensus_results}{Results from interactive_consensus_annotation function}

\item{top_n}{Number of top marker genes to display per cell type (default: 5)}

\item{title}{Plot title (default: "Marker Gene Expression Heatmap")}

\item{color_palette}{Color palette for the heatmap (default: viridis::plasma)}

\item{cluster_genes}{Whether to cluster genes hierarchically (default: TRUE)}

\item{scale_method}{Scaling method: "row", "column", or "none" (default: "row")}

\item{width}{Image width in pixels (default: 4000)}

\item{height}{Image height in pixels (default: 3000)}

\item{fontsize}{Base font size for the heatmap (default: 20)}

\item{cellwidth}{Width of each cell in the heatmap (default: 100)}

\item{cellheight}{Height of each cell in the heatmap (default: 50)}

\item{margins}{Margins around the heatmap as c(bottom, right) (default: c(20, 20))}
}
\value{
A matrix containing the expression data used for the heatmap
}
\description{
Creates a publication-ready heatmap showing marker gene expression across cell types.
The heatmap displays scaled expression values with hierarchical clustering of genes.
}
\examples{
\dontrun{
# Create heatmap with default settings (optimized for complete display)
heatmap_matrix <- create_marker_heatmap(
  seurat_obj = pbmc_data,
  markers_df = markers_df,
  consensus_results = consensus_results,
  top_n = 5
)

# Create heatmap with custom settings
heatmap_matrix <- create_marker_heatmap(
  seurat_obj = pbmc_data,
  markers_df = markers_df,
  consensus_results = consensus_results,
  top_n = 3,
  title = "Top 3 Marker Genes",
  fontsize = 16,
  cellwidth = 80,
  cellheight = 40,
  cluster_genes = FALSE
)
}

}
